<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>

<style>

.mypage-body-con{
	background-color: #fff;
	border-radius: 30px;
 	padding: 24px; 
 	height: 800px;
}
.body-sub-title{
	font-size: 24px;
	font-weight: bold;
	margin-bottom: 8px;
}

.title-hr{
	border: 1px solid green;
	margin-bottom: 8px;
}
.body-sub-con{
	padding: 0px 160px 0px 160px;
}
/* 프로필 css */

.pro-img-inner{
	display: none;
}
.profile-box{
	height: 160px;
	text-align: center;
}
.pro-img-box{
	width: 160px;
	height:160px;
 	object-fit: cover;
	border-radius: 10px;
}
.pro-label{
	font-size: 14px;

}
.pro-input-text{
	height: 48px;
    width: 730px;
    border: 1px solid #ccc;
    border-radius: 8px;
    padding: 12px 20px; 
}
.birth-tell{
    width: 730px;
    display: flex;
    align-items: center;
    justify-content: space-between;
}
.mem-tell-input{
	width: 400px;
}
.pro-select-box{
    display: flex;
    width: 730px;
    justify-content: space-between;

}
.pro-btn-box{
	margin-top: 24px;
    text-align: right;
}
.pro-memIntrcn{
	width: 730px;
}

.labelgroup{
	display: flex;
}

.pro-input01 {
	padding: 12px 12px;
	border-radius: 10px;
	border: 1px solid #ccc;
	width: 100%;
    margin-bottom: 10px;
}

.ent-pro-sel {
	display: flex;
    flex-direction: row;
    margin-right: 50%;
    margin-bottom: 20px;
}

.labelnum{
	padding: 5px;
}
.input_width{
	width:100%;
}
.pro-btn{
	font-size: 14px;
	display:inline-flex;
	justify-content:center;
	align-items:center;
    background-color: white;
    border: 1px solid rgb(212, 212, 212);
    border-radius: 5px;
    height: 36px;
    cursor: pointer;
    padding: 0 13px;
    margin: 20px 5px 15px 20px;

}

.pro-btn:hover{
	opacity: 0.8; 
	background-color: #60BD89;
	color: white;
}


</style>


<div class="mypage-body-con">
	<div class="sub-title-area">
		<div class="body-sub-title">기업 프로필</div>
	<br />
		<hr class="title-hr" />
	</div>
	<!-- MemberVO(memId=t001, memPass=$2a$10$9oxEwPctyRNT0x/z26MGbeMHcDft62W/VIkeNSDM9yvfXgBajJujO,
	memNm=박태경, memPostno=06112, memAddr=서울 강남구 논현로123길 4-1, memAddr2=123, memTel=01011112222,
	memRegDt=Tue Dec 19 19:41:20 KST 2023, memOpenResume=1, memStateCd=null, memBirth=Sat Dec 02 00:00:00 KST 2023,
	memGen=0, memEmail=tt@naver.com, memCd=RRD01001, memYn=null, memIntrcn=null, memNcnm=null,
	memAfId=t001, memWishJobCate=null, memWishJob=null, enabled=1, memIntWord=null, entNo=null, sort=null, keyword=null,
	memberAuthVOList=[MemberAuthVO(memId=t001, role=ROLE_ENTERPRISE)],
 -->	
 		<div class="body-sub-con">
		<form action="/enter/updatePost?${_csrf.parameterName}=${_csrf.token}" method="post" enctype="multipart/form-data">
		
<%--  	${memberVO.atchfileDetailVO} --%>
			<p style="display: flex; justify-content: flex-end; margin: 0px 10px 10px 0px; ">
			 	<button type="button" id="privateBtn" class="pro-btn" >개인프로필</button>
			 	<button type="button" id="enterBtn" class="pro-btn" >기업프로필</button>
			</p>
		
			<input type="hidden" name="memId" value="${memberVO.memId}">
			
			<div class="profile-box">
				<label for="profile" class="pro-img-label">
					<c:if test="${memberVO.atchfileDetailVO[0].afdSaveNm==null}">
						<img class="pro-img-box" alt="프로필 사진" src="/resources/images/default_profile.png">
					</c:if>
					<c:if test="${memberVO.atchfileDetailVO[0].afdSaveNm!=null}">
						<img class="pro-img-box" alt="프로필 사진" src="/resources/upload/${memberVO.atchfileDetailVO[0].afdSaveNm}">
					</c:if>

				</label>
	            <input type="file" id="profile" name="uploadFile" class="pro-img-inner" value="프로필사진" />
			</div>
			
			<div>
			
			<div class="labelgroup">
				<div class="labelnum" style="flex:1;">
					<p class="name-label required">이름</p>
					<input type="text" name="memNm" value="${memberVO.memNm}" class="pro-input-text input_width" />
				</div>
			</div>
			
			<p class="name-label required">주소</p>
				<div class="labelnum" style="flex:1;">
                    <input class="pro-input-text" type="text" name="memPostno" id="postcode" value="${memberVO.memPostno}" style="width: 80%">
                    <input class="btn" type="button" onclick="execDaumPostcode(this)" value="우편번호 찾기" style="margin-left: 10px;"><br>
                </div>
				<div class="labelnum" style="flex:1;">
                	<input class="pro-input-text" type="text" name="memAddr" id="address" value="${memberVO.memAddr}" style="margin-bottom: 10px;"/><br>
                	<input class="pro-input-text" type="text" name="memAddr2" id="detailAddress" value="${memberVO.memAddr2}" placeholder="상세주소"><br/>
				</div>                

				<div class="labelgroup">
					<div class="labelnum" style="flex:1;">
						<p class="name-label required">생년월일</p>
						<input type="date" name="memBirth" value="<fmt:formatDate value="${memberVO.memBirth}" pattern="yyyy-MM-dd" />"
							class="pro-input-text input_width" display: inline-block;">
					</div>
					
					<div class="labelnum" style="flex:1;">
						<p class="name-label">연락처</p>
						<input type="text" name="memTel" class="input01 noSpecial input_width" value="${memberVO.memTel}" />
					</div>
				</div>
				
				<div class="labelnum" style="flex:1;">
					<p class="name-label mt-15">이메일</p>
					<input type="text" name="memEmail" class="pro-input-text input_width" value="${memberVO.memEmail}" />
				</div>
				
				<div class="pro-select-box">
				<div class="labelnum" style="flex:1;">
					<div class="name-label mt-15">
						<span class="name-label required" required>닉네임</span>
						<span class="p-info"> 닉네임은 취업 Q&A 게시판에서 사용될 명칭입니다. </span>
						<p><input type="text" name="memNcnm" class="pro-input01" value="${memberVO.memNcnm}" /></p>
					</div>
					</div>

					<div>
	                <p class="name-label required">성별</p>
		                <fieldset>
		                    <label>
		                        <input type="radio" name="memGen" value="0" <c:if test="${memberVO.memGen==0}">checked</c:if> />
		                        <span>남자</span>
		                    </label>
		                    <label>
		                        <input type="radio" name="memGen" value="1" <c:if test="${memberVO.memGen==1}">checked</c:if> />
		                        <span>여자</span>
		                    </label>
		                </fieldset>
					</div>
				</div>
						
			<div class="labelgroup">
			    <div class="labelnum" style="flex:1;">
			        <p class="name-label required">직급선택</p>
			        <select name="memMgPosition" class="input01 input_width">
			            <c:forEach var="comDetCodeInfoVOList" items="${comDetCodeInfoVOList1}">
			                <option value="${comDetCodeInfoVOList.comDetCd}" <c:if test="${comDetCodeInfoVOList.comDetCd eq getCurrentLoginVO.memMgPosition}">selected</c:if>>${comDetCodeInfoVOList.comDetCdNm}</option>
			            </c:forEach>
			        </select>
			    </div>
			</div>
			</div>
			
			<div class="pro-btn-box">
				<button type="submit" class="btn btn-write">프로필 저장</button>
			</div>
			<br />

			<sec:csrfInput />
	</form>
	</div>
</div>

<script type="text/javascript">
$(function(){
	$("#profile").on("change",function(e){
		let files = e.target.files;
		console.log("files : " + files);
		let filesArr = Array.prototype.slice.call(files);
		//파일객체배열->파일객체(f)
		filesArr.forEach(function(f){
			if(!f.type.match("image.*")){
	            alert("이미지 확장자만 가능합니다.");
	            $("#profile").val('');
	            return;
	        }
			
			let reader = new FileReader();
	        //e : reader가 이미지 객체를 읽는 이벤트
	        reader.onload = function(e){
	            //요소.append : 누적, 요소.html : 새로고침, 요소.innerHTML : J/S에서 새로고침
	            $(".pro-img-box").attr("src",e.target.result);
// 	            $(".pro-img-box").css({"background-position":"center","background-size":"cover"});
// 	            $(".pro-img-box").css({"object-fit": "cover"});
	        }
	        reader.readAsDataURL(f);
		});
	});
});

//다음 우편번호 api
function execDaumPostcode(e) {
 new daum.Postcode({
     oncomplete: function(data) {
         // 팝업에서 검색결과 항목을 클릭했을때 실행할 코드를 작성하는 부분.

         // 각 주소의 노출 규칙에 따라 주소를 조합한다.
         // 내려오는 변수가 값이 없는 경우엔 공백('')값을 가지므로, 이를 참고하여 분기 한다.
         var addr = ''; // 주소 변수

         //사용자가 선택한 주소 타입에 따라 해당 주소 값을 가져온다.
         if (data.userSelectedType === 'R') { // 사용자가 도로명 주소를 선택했을 경우
             addr = data.roadAddress;
         } else { // 사용자가 지번 주소를 선택했을 경우(J)
             addr = data.jibunAddress;
         }

		console.dir(e)
		
		let postcode = e.previousElementSibling;
		let address = e.parentElement.nextElementSibling;
		let detailAddress = e.parentElement.nextElementSibling.nextElementSibling.nextElementSibling;
	
		console.log(postcode);
		console.log(address);
		console.log(detailAddress);
		
         // 우편번호와 주소 정보를 해당 필드에 넣는다.
         postcode.value = data.zonecode;
         address.value = addr;
         // 커서를 상세주소 필드로 이동한다.
         detailAddress.focus();
     }
 }).open();
}
//$(document).ready(function(){ => 페이지에서 동적으로 추가 할때?쓴다고 생각하믄댕?
		
$(function(){
	
	$("#privateBtn").on("click",function(){
		console.log("!!@!!");
	});
	
	$("#enterBtn").on("click", function() {
		console.log("~~~~");
		
	});
});


	
// 	<div class="labelgroup">
// 	<div class="labelnum">
// 		<div class="flex align-base mb-7">
// 			<p class="name-label required mb-0">사업자등록번호</p>
// 			<span style="font-size: 14px"></span>
// 		</div>
// 		<input type="text" id="input-num" name="entNo" class="input01 noSpecial" value="${enterpriseVO.entNo}" disabled />
// 	</div>
	
// 	<div class="labelnum">
// 		<p class="name-label required">기업명</p>
// 		<input type="text" id="input-num" name="entNm" class="input01" value="${enterpriseVO.entNm}" disabled />
// 	</div>

// 	<div class="labelnum">
// 		<p class="name-label required">팩스번호</p>
// 		<input type="text" id="input-num" name="entFax" class="input01 no noSpecial" value="${enterpriseVO.entFax}" />
// 	</div>
// </div>

// <p class="name-label required mt-15">주소</p>

// <div style="display: flex;">
// 	<input class="pro-input-text pro-input01" type="text" name="memPostno" id="postcode" value="${enterpriseVO.entPostno}" /> <input
// 		class="btn" type="button" onclick="execDaumPostcode(this)" value="우편번호 찾기" style="margin-left: 10px;"><br>
// </div>

// <input class="pro-input-text pro-input01" type="text" name="memAddr" id="address" value="${enterpriseVO.entAddr}" /><br>
// <input class="pro-input-text pro-input01" type="text" name="memAddr2" id="detailAddress" value="${enterpriseVO.entAddr2}" /><br />
	

// <div class="labelgroup mt-15">
// 	<div style="width: 100%;">
// 		<p class="name-label">기업 소개</p>
// 		<textarea name="entIntrcn" class="input01 textarea01 input_width">${enterpriseVO.entIntrcn}</textarea>
// 	</div>
// </div>

// <div class="labelgroup mt-15">
// 	<div class="labelnum" style="flex:1;">
// 		<p class="name-label required">대표자명</p>
// 		<input type="text" name="entCeonm" class="input01 input_width" value="${enterpriseVO.entCeonm}" />
// 	</div>
	
// 	<div class="labelnum" style="flex:1;">
// 		<p class="name-label required">기업 직원수</p>
// 		<input type="text" name="entEmpcnt" onkeyup="numberComma(this)"
// 			class="input01 talign-right noSpecial input_width" value="${enterpriseVO.entEmpcnt}" />
// 	</div>
// </div>

// <div class="labelgroup mt-15">
// 	<div class="labelnum" style="flex:1;">
// 		<p class="name-label required">설립일자</p>
// 		<input type="date" name="entBday" class="input01 input_width" value="${enterpriseVO.entBday}" />
// 	</div>
	
// 	<div class="labelnum" style="flex:1;">
// 		<p class="name-label required">기업 매출액</p>
// 		<input type="text" name="entSales" onkeyup="numberComma(this)"
// 			class="input01 talign-right noSpecial input_width" value="${enterpriseVO.entSales}" />
// 	</div>
// </div>
	
// <div class="labelgroup mt-15">
// 	<div class="labelnum" style="flex:1;">
// 		<p class="name-label">기업 사이트 주소</p>
// 		<input type="text" id="ent-site" name="entUrl" class="input01 input_width" value="${enterpriseVO.entUrl}" />
// 	</div>
// </div>			

// <div class="labelgroup">
// 	<div class="labelnum" style="flex:1;">
// 		<p class="name-label required">기업 산업군</p>
// 		<select name="entSector" class="input01 input_width" >
// 			<c:forEach var="comCodeInfoVOList" items="${comCodeInfoVOList}">
//                 <option value="${comCodeInfoVOList.comCd}" <c:if test="${comCodeInfoVOList.comCd eq enterpriseVO.entSector}">selected="selected"</c:if>>${comCodeInfoVOList.comCdNm}</option>
//             </c:forEach>
// 		</select>
// 	</div>
// 	<div class="labelnum" style="flex:1;">
// 		<p class="name-label required">기업 관심키워드</p>
// 		<select name="entIntWord" class="input01 input_width" >
// 			<c:forEach var="comDetCodeInfoVOList" items="${comDetCodeInfoVOList}">
//                 <option value="${comDetCodeInfoVOList.comDetCd}" <c:if test="${comDetCodeInfoVOList.comDetCd eq enterpriseVO.entIntWord}">selected="selected"</c:if>>${comDetCodeInfoVOList.comDetCdNm}</option>
//             </c:forEach>
// 		</select>
// 	</div>
// </div>
	 
	
</script>
<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>

